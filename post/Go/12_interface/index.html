<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    

    <title>Go语言基础之接口 | 魏奇的博客</title>
    <meta property="og:title" content="Go语言基础之接口 - 魏奇的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2019-05-02T00:00:00&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2019-05-02T00:00:00&#43;08:00'>
        
    <meta name="Keywords" content="golang,go语言,go语言笔记,java,android,博客,项目管理,python,软件架构,公众号,小程序">
    <meta name="description" content="Go语言基础之接口">
        
    <meta name="author" content="魏奇">
    <meta property="og:url" content="https://blog.imw7.com/post/Go/12_interface/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
        <link href="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" rel="stylesheet">
    
    
    
    
        <link rel="stylesheet" href='/css/douban.css'>
    
        <link rel="stylesheet" href='/css/other.css'>
    
</head>


<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://blog.imw7.com/">
                        魏奇的博客
                    </a>
                
                <p class="description">海阔凭鱼跃，天高任鸟飞</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://blog.imw7.com/">首页</a>
                    
                    <a  href="https://blog.imw7.com/archives/" title="归档">归档</a>
                    
                    <a  href="https://blog.imw7.com/about/" title="关于">关于</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: absolute;
        top: 0;
        right: 0;
        width: 200px;
        margin-right: 0px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 45%;
        overflow-y: auto;
        overflow-x: hidden;
        float: right;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 18px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 12px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 8px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 10px;
        list-style: none;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul ul ul ul {
        margin-right: 10px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="top: 280px; right: 0px; float: right;">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#接口类型">接口类型</a></li>
    <li><a href="#为什么要使用接口">为什么要使用接口</a></li>
    <li><a href="#接口的定义">接口的定义</a></li>
    <li><a href="#实现接口的条件">实现接口的条件</a></li>
    <li><a href="#接口类型变量">接口类型变量</a></li>
    <li><a href="#值接收者和指针接收者实现接口的区别">值接收者和指针接收者实现接口的区别</a>
      <ul>
        <li><a href="#值接收者实现接口">值接收者实现接口</a></li>
        <li><a href="#指针接收者实现接口">指针接收者实现接口</a></li>
        <li><a href="#面试题">面试题</a></li>
      </ul>
    </li>
    <li><a href="#类型与接口的关系">类型与接口的关系</a>
      <ul>
        <li><a href="#一个类型实现多个接口">一个类型实现多个接口</a></li>
        <li><a href="#多个类型实现同一接口">多个类型实现同一接口</a></li>
      </ul>
    </li>
    <li><a href="#接口嵌套">接口嵌套</a></li>
    <li><a href="#空接口">空接口</a>
      <ul>
        <li><a href="#空接口的定义">空接口的定义</a></li>
        <li><a href="#空接口的应用">空接口的应用</a></li>
      </ul>
    </li>
    <li><a href="#类型断言">类型断言</a>
      <ul>
        <li><a href="#接口值">接口值</a></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var rightPos = window.screenX+$("#main").offset().left;
            if(rightPos<220){
                postToc.css({"width":rightPos+10,"margin-right":0})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">Go语言基础之接口</h1>
        </header>
        <date class="post-meta meta-date">
            2019年5月2日
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='/categories/Go'>Go</a></span>
            
        </div>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">| 本文阅读量 <span id="busuanzi_value_page_pv"></span><span> 次</span></span>
                     
        </div>
        
        
        <div class="clear" style="display: none;">
            <div class="toc-article" style="float: right;">
                <div class="toc-title">文章目录</div>
            </div>
        </div>
        
        <div class="post-content">
            <p>接口（interface）定义了一个对象的行为规范，只定义规范不实现，由具体的对象来实现规范的细节。</p>
<h1 id="接口">接口</h1>
<h2 id="接口类型">接口类型</h2>
<p>在Go语言中接口（interface）是一种类型，一种抽象的类型。</p>
<p><code>interface</code>是一组<code>method</code>的集合，是<code>duck-type programming</code>的一种体现。接口做的事情就像是定义一个协议（规则），只要一台机器有洗衣服和甩干的功能，我就称它为洗衣机。不关心属性（数据），只关心行为（方法）。</p>
<p>为了保护你的Go语言职业生涯，请牢记接口（interface）是一种类型。</p>
<h2 id="为什么要使用接口">为什么要使用接口</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> Cat <span style="font-weight:bold;font-style:italic">struct</span>{}

<span style="font-weight:bold;font-style:italic">func</span> (c Cat) <span style="color:#666;font-weight:bold;font-style:italic">Say</span>() <span style="font-weight:bold">string</span> { <span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;喵喵喵&#34;</span> }

<span style="font-weight:bold;font-style:italic">type</span> Dog <span style="font-weight:bold;font-style:italic">struct</span>{}

<span style="font-weight:bold;font-style:italic">func</span> (d Dog) <span style="color:#666;font-weight:bold;font-style:italic">Say</span>() <span style="font-weight:bold">string</span> { <span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;汪汪汪&#34;</span> }

<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	c := Cat{}
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;猫:&#34;</span>, c.<span style="color:#666;font-weight:bold;font-style:italic">Say</span>())
	d := Dog{}
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;狗:&#34;</span>, d.<span style="color:#666;font-weight:bold;font-style:italic">Say</span>())
}
</code></pre></td></tr></table>
</div>
</div><p>上面的代码中定义了猫和狗，然后它们都会叫，你会发现main函数中明显有重复的代码，如果我们后续再加上猪、青蛙等动物的话，我们的代码还会一直重复下去。那我们能不能把它们当成“能叫的动物”来处理呢？</p>
<p>像类似的例子在我们编程过程中会经常遇到：</p>
<p>比如一个网上商城可能使用支付宝、微信、银联等方式去在线支付，我们能不能把它们当成“支付方式”来处理呢？</p>
<p>比如三角形，四边形，圆形都能计算周长和面积，我们能不能把它们当成“图形”来处理呢？</p>
<p>比如销售、行政、程序员都能计算月薪，我们能不能把他们当成“员工”来处理呢？</p>
<p>Go语言中为了解决类似上面的问题，就设计了接口这个概念。接口区别于我们之前所有的具体类型，接口是一种抽象的类型。当你看到一个接口类型的值时，你不知道它是什么，唯一知道的是通过它的方法能做什么。</p>
<h2 id="接口的定义">接口的定义</h2>
<p>Go语言提倡面向接口编程。</p>
<p>每个接口由数个方法组成，接口的定义格式如下：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> 接口类型名 <span style="font-weight:bold;font-style:italic">interface</span>{
    方法名1( 参数列表1 ) 返回值列表1
    方法名2( 参数列表2 ) 返回值列表2
    <span style="">…</span>
}
</code></pre></td></tr></table>
</div>
</div><p>其中：</p>
<ul>
<li>接口名：使用<code>type</code>将接口定义为自定义的类型名。Go语言的接口在命名时，一般会在单词后面添加<code>er</code>，如有写操作的接口叫<code>Writer</code>，有字符串功能的接口叫<code>Stringer</code>等。接口名最好要能突出该接口的类型含义。</li>
<li>方法名：当方法名首字母是大写且这个接口类型名首字母也是大写时，这个方法可以被接口所在的包（package）之外的代码访问。</li>
<li>参数列表、返回值列表：参数列表和返回值列表中的参数变量名可以省略。</li>
</ul>
<p>举个例子：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> writer <span style="font-weight:bold;font-style:italic">interface</span>{
    <span style="color:#666;font-weight:bold;font-style:italic">Write</span>([]<span style="font-weight:bold">byte</span>) <span style="font-weight:bold">error</span>
}
</code></pre></td></tr></table>
</div>
</div><p>当你看到这个接口类型的值时，你不知道它是什么，唯一知道的就是可以通过它的Write方法来做一些事情。</p>
<h2 id="实现接口的条件">实现接口的条件</h2>
<p>一个对象只要全部实现了接口中的方法，那么就实现了这个接口。换句话说，接口就是一个<strong>需要实现的方法列表</strong>。</p>
<p>我们来定义一个<code>Sayer</code>接口：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// Sayer 接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> Sayer <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">say</span>()
}
</code></pre></td></tr></table>
</div>
</div><p>定义<code>dog</code>和<code>cat</code>两个结构体：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> dog <span style="font-weight:bold;font-style:italic">struct</span> {}

<span style="font-weight:bold;font-style:italic">type</span> cat <span style="font-weight:bold;font-style:italic">struct</span> {}
</code></pre></td></tr></table>
</div>
</div><p>因为<code>Sayer</code>接口里只有一个<code>say</code>方法，所以我们只需要给<code>dog</code>和<code>cat </code>分别实现<code>say</code>方法就可以实现<code>Sayer</code>接口了。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// dog实现了Sayer接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (d dog) <span style="color:#666;font-weight:bold;font-style:italic">say</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;汪汪汪&#34;</span>)
}

<span style="color:#888;font-style:italic">// cat实现了Sayer接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (c cat) <span style="color:#666;font-weight:bold;font-style:italic">say</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;喵喵喵&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><p>接口的实现就是这么简单，只要实现了接口中的所有方法，就实现了这个接口。</p>
<h2 id="接口类型变量">接口类型变量</h2>
<p>那实现了接口有什么用呢？</p>
<p>接口类型变量能够存储所有实现了该接口的实例。 例如上面的示例中，<code>Sayer</code>类型的变量能够存储<code>dog</code>和<code>cat</code>类型的变量。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="font-weight:bold;font-style:italic">var</span> x Sayer <span style="color:#888;font-style:italic">// 声明一个Sayer类型的变量x
</span><span style="color:#888;font-style:italic"></span>	a := cat{}  <span style="color:#888;font-style:italic">// 实例化一个cat
</span><span style="color:#888;font-style:italic"></span>	b := dog{}  <span style="color:#888;font-style:italic">// 实例化一个dog
</span><span style="color:#888;font-style:italic"></span>	x = a       <span style="color:#888;font-style:italic">// 可以把cat实例直接赋值给x
</span><span style="color:#888;font-style:italic"></span>	x.<span style="color:#666;font-weight:bold;font-style:italic">say</span>()     <span style="color:#888;font-style:italic">// 喵喵喵
</span><span style="color:#888;font-style:italic"></span>	x = b       <span style="color:#888;font-style:italic">// 可以把dog实例直接赋值给x
</span><span style="color:#888;font-style:italic"></span>	x.<span style="color:#666;font-weight:bold;font-style:italic">say</span>()     <span style="color:#888;font-style:italic">// 汪汪汪
</span><span style="color:#888;font-style:italic"></span>}
</code></pre></td></tr></table>
</div>
</div><p><strong>Tips：</strong> 观察下面的代码，体味此处<code>_</code>的妙用</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// 摘自gin框架routergroup.go
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> IRouter <span style="font-weight:bold;font-style:italic">interface</span>{ ... }

<span style="font-weight:bold;font-style:italic">type</span> RouterGroup <span style="font-weight:bold;font-style:italic">struct</span> { ... }

<span style="font-weight:bold;font-style:italic">var</span> _ IRouter = &amp;RouterGroup{}  <span style="color:#888;font-style:italic">// 确保RouterGroup实现了接口IRouter
</span></code></pre></td></tr></table>
</div>
</div><h2 id="值接收者和指针接收者实现接口的区别">值接收者和指针接收者实现接口的区别</h2>
<p>使用值接收者实现接口和使用指针接收者实现接口有什么区别呢？接下来我们通过一个例子看一下其中的区别。</p>
<p>我们有一个<code>Mover</code>接口和一个<code>dog</code>结构体。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> Mover <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
}

<span style="font-weight:bold;font-style:italic">type</span> dog <span style="font-weight:bold;font-style:italic">struct</span> {}
</code></pre></td></tr></table>
</div>
</div><h3 id="值接收者实现接口">值接收者实现接口</h3>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">func</span> (d dog) <span style="color:#666;font-weight:bold;font-style:italic">move</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;狗会动&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><p>此时实现接口的是<code>dog</code>类型：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="font-weight:bold;font-style:italic">var</span> x Mover
	<span style="font-weight:bold;font-style:italic">var</span> wangcai = dog{} <span style="color:#888;font-style:italic">// 旺财是dog类型
</span><span style="color:#888;font-style:italic"></span>	x = wangcai         <span style="color:#888;font-style:italic">// x可以接收dog类型
</span><span style="color:#888;font-style:italic"></span>	<span style="font-weight:bold;font-style:italic">var</span> fugui = &amp;dog{}  <span style="color:#888;font-style:italic">// 富贵是*dog类型
</span><span style="color:#888;font-style:italic"></span>	x = fugui           <span style="color:#888;font-style:italic">// x可以接收*dog类型
</span><span style="color:#888;font-style:italic"></span>	x.<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
}
</code></pre></td></tr></table>
</div>
</div><p>从上面的代码中我们可以发现，使用值接收者实现接口之后，不管是dog结构体还是结构体指针*dog类型的变量都可以赋值给该接口变量。因为Go语言中有对指针类型变量求值的语法糖，dog指针<code>fugui</code>内部会自动求值<code>*fugui</code>。</p>
<h3 id="指针接收者实现接口">指针接收者实现接口</h3>
<p>同样的代码我们再来测试一下使用指针接收者有什么区别：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">func</span> (d *dog) <span style="color:#666;font-weight:bold;font-style:italic">move</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;狗会动&#34;</span>)
}
<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="font-weight:bold;font-style:italic">var</span> x Mover
	<span style="font-weight:bold;font-style:italic">var</span> wangcai = dog{} <span style="color:#888;font-style:italic">// 旺财是dog类型
</span><span style="color:#888;font-style:italic"></span>	x = wangcai         <span style="color:#888;font-style:italic">// x不可以接收dog类型
</span><span style="color:#888;font-style:italic"></span>	<span style="font-weight:bold;font-style:italic">var</span> fugui = &amp;dog{}  <span style="color:#888;font-style:italic">// 富贵是*dog类型
</span><span style="color:#888;font-style:italic"></span>	x = fugui           <span style="color:#888;font-style:italic">// x可以接收*dog类型
</span><span style="color:#888;font-style:italic"></span>}
</code></pre></td></tr></table>
</div>
</div><p>此时实现<code>Mover</code>接口的是<code>*dog</code>类型，所以不能给<code>x</code>传入<code>dog</code>类型的wangcai，此时x只能存储<code>*dog</code>类型的值。</p>
<h3 id="面试题">面试题</h3>
<p>**注意：**这是一道你需要回答“能”或者“不能”的题！</p>
<p>首先请观察下面的这段代码，然后请回答这段代码能不能通过编译？</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> People <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">Speak</span>(<span style="font-weight:bold">string</span>) <span style="font-weight:bold">string</span>
}

<span style="font-weight:bold;font-style:italic">type</span> Student <span style="font-weight:bold;font-style:italic">struct</span>{}

<span style="font-weight:bold;font-style:italic">func</span> (stu *Student) <span style="color:#666;font-weight:bold;font-style:italic">Speak</span>(think <span style="font-weight:bold">string</span>) (talk <span style="font-weight:bold">string</span>) {
	<span style="font-weight:bold">if</span> think == <span style="color:#666;font-style:italic">&#34;handsome&#34;</span> {
		talk = <span style="color:#666;font-style:italic">&#34;帅哥&#34;</span>
	} <span style="font-weight:bold">else</span> {
		talk = <span style="color:#666;font-style:italic">&#34;美女&#34;</span>
	}
	<span style="font-weight:bold">return</span>
}

<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="font-weight:bold;font-style:italic">var</span> peo People = Student{}
	think := <span style="color:#666;font-style:italic">&#34;girl&#34;</span>
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(peo.<span style="color:#666;font-weight:bold;font-style:italic">Speak</span>(think))
}
</code></pre></td></tr></table>
</div>
</div><h2 id="类型与接口的关系">类型与接口的关系</h2>
<h3 id="一个类型实现多个接口">一个类型实现多个接口</h3>
<p>一个类型可以同时实现多个接口，而接口间彼此独立，不知道对方的实现。 例如，狗可以叫，也可以动。我们就分别定义Sayer接口和Mover接口，如下： <code>Mover</code>接口。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// Sayer 接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> Sayer <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">say</span>()
}

<span style="color:#888;font-style:italic">// Mover 接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> Mover <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
}
</code></pre></td></tr></table>
</div>
</div><p>dog既可以实现Sayer接口，也可以实现Mover接口。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> dog <span style="font-weight:bold;font-style:italic">struct</span> {
	name <span style="font-weight:bold">string</span>
}

<span style="color:#888;font-style:italic">// 实现Sayer接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (d dog) <span style="color:#666;font-weight:bold;font-style:italic">say</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;%s会叫汪汪汪\n&#34;</span>, d.name)
}

<span style="color:#888;font-style:italic">// 实现Mover接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (d dog) <span style="color:#666;font-weight:bold;font-style:italic">move</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;%s会动\n&#34;</span>, d.name)
}

<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="font-weight:bold;font-style:italic">var</span> x Sayer
	<span style="font-weight:bold;font-style:italic">var</span> y Mover

	<span style="font-weight:bold;font-style:italic">var</span> a = dog{name: <span style="color:#666;font-style:italic">&#34;旺财&#34;</span>}
	x = a
	y = a
	x.<span style="color:#666;font-weight:bold;font-style:italic">say</span>()
	y.<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
}
</code></pre></td></tr></table>
</div>
</div><h3 id="多个类型实现同一接口">多个类型实现同一接口</h3>
<p>Go语言中不同的类型还可以实现同一接口 首先我们定义一个<code>Mover</code>接口，它要求必须由一个<code>move</code>方法。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// Mover 接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> Mover <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
}
</code></pre></td></tr></table>
</div>
</div><p>例如狗可以动，汽车也可以动，可以使用如下代码实现这个关系：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> dog <span style="font-weight:bold;font-style:italic">struct</span> {
	name <span style="font-weight:bold">string</span>
}

<span style="font-weight:bold;font-style:italic">type</span> car <span style="font-weight:bold;font-style:italic">struct</span> {
	brand <span style="font-weight:bold">string</span>
}

<span style="color:#888;font-style:italic">// dog类型实现Mover接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (d dog) <span style="color:#666;font-weight:bold;font-style:italic">move</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;%s会跑\n&#34;</span>, d.name)
}

<span style="color:#888;font-style:italic">// car类型实现Mover接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (c car) <span style="color:#666;font-weight:bold;font-style:italic">move</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;%s速度70迈\n&#34;</span>, c.brand)
}
</code></pre></td></tr></table>
</div>
</div><p>这个时候我们在代码中就可以把狗和汽车当成一个会动的物体来处理了，不再需要关注它们具体是什么，只需要调用它们的<code>move</code>方法就可以了。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="font-weight:bold;font-style:italic">var</span> x Mover
	<span style="font-weight:bold;font-style:italic">var</span> a = dog{name: <span style="color:#666;font-style:italic">&#34;旺财&#34;</span>}
	<span style="font-weight:bold;font-style:italic">var</span> b = car{brand: <span style="color:#666;font-style:italic">&#34;保时捷&#34;</span>}
	x = a
	x.<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
	x = b
	x.<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
}
</code></pre></td></tr></table>
</div>
</div><p>上面的代码执行结果如下：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">旺财会跑
保时捷速度70迈
</code></pre></td></tr></table>
</div>
</div><p>并且一个接口的方法，不一定需要由一个类型完全实现，接口的方法可以通过在类型中嵌入其他类型或者结构体来实现。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// WashingMachine 洗衣机
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> WashingMachine <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">wash</span>()
	<span style="color:#666;font-weight:bold;font-style:italic">dry</span>()
}

<span style="color:#888;font-style:italic">// 甩干器
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> dryer <span style="font-weight:bold;font-style:italic">struct</span>{}

<span style="color:#888;font-style:italic">// 实现WashingMachine接口的dry()方法
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (d dryer) <span style="color:#666;font-weight:bold;font-style:italic">dry</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;甩一甩&#34;</span>)
}

<span style="color:#888;font-style:italic">// 海尔洗衣机
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> haier <span style="font-weight:bold;font-style:italic">struct</span> {
	dryer <span style="color:#888;font-style:italic">//嵌入甩干器
</span><span style="color:#888;font-style:italic"></span>}

<span style="color:#888;font-style:italic">// 实现WashingMachine接口的wash()方法
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (h haier) <span style="color:#666;font-weight:bold;font-style:italic">wash</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;洗刷刷&#34;</span>)
}
</code></pre></td></tr></table>
</div>
</div><h2 id="接口嵌套">接口嵌套</h2>
<p>接口与接口间可以通过嵌套创造出新的接口。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// Sayer 接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> Sayer <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">say</span>()
}

<span style="color:#888;font-style:italic">// Mover 接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> Mover <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
}

<span style="color:#888;font-style:italic">// 接口嵌套
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> animal <span style="font-weight:bold;font-style:italic">interface</span> {
	Sayer
	Mover
}
</code></pre></td></tr></table>
</div>
</div><p>嵌套得到的接口的使用与普通接口一样，这里我们让cat实现animal接口：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">type</span> cat <span style="font-weight:bold;font-style:italic">struct</span> {
	name <span style="font-weight:bold">string</span>
}

<span style="font-weight:bold;font-style:italic">func</span> (c cat) <span style="color:#666;font-weight:bold;font-style:italic">say</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;喵喵喵&#34;</span>)
}

<span style="font-weight:bold;font-style:italic">func</span> (c cat) <span style="color:#666;font-weight:bold;font-style:italic">move</span>() {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;猫会动&#34;</span>)
}

<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="font-weight:bold;font-style:italic">var</span> x animal
	x = cat{name: <span style="color:#666;font-style:italic">&#34;花花&#34;</span>}
	x.<span style="color:#666;font-weight:bold;font-style:italic">move</span>()
	x.<span style="color:#666;font-weight:bold;font-style:italic">say</span>()
}
</code></pre></td></tr></table>
</div>
</div><h2 id="空接口">空接口</h2>
<h3 id="空接口的定义">空接口的定义</h3>
<p>空接口是指没有定义任何方法的接口。因此任何类型都实现了空接口。</p>
<p>空接口类型的变量可以存储任意类型的变量。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="color:#888;font-style:italic">// 定义一个空接口x
</span><span style="color:#888;font-style:italic"></span>	<span style="font-weight:bold;font-style:italic">var</span> x <span style="font-weight:bold;font-style:italic">interface</span>{}
	s := <span style="color:#666;font-style:italic">&#34;Hello 世界&#34;</span>
	x = s
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;type:%T value:%v\n&#34;</span>, x, x)
	i := 100
	x = i
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;type:%T value:%v\n&#34;</span>, x, x)
	b := <span style="font-weight:bold">true</span>
	x = b
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;type:%T value:%v\n&#34;</span>, x, x)
}
</code></pre></td></tr></table>
</div>
</div><h3 id="空接口的应用">空接口的应用</h3>
<h4 id="空接口作为函数的参数">空接口作为函数的参数</h4>
<p>使用空接口实现可以接收任意类型的函数参数。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// 空接口作为函数参数
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">show</span>(a <span style="font-weight:bold;font-style:italic">interface</span>{}) {
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;type:%T value:%v\n&#34;</span>, a, a)
}
</code></pre></td></tr></table>
</div>
</div><h4 id="空接口作为map的值">空接口作为map的值</h4>
<p>使用空接口实现可以保存任意值的字典。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#888;font-style:italic">// 空接口作为map值
</span><span style="color:#888;font-style:italic"></span>	<span style="font-weight:bold;font-style:italic">var</span> studentInfo = <span style="font-weight:bold;font-style:italic">make</span>(<span style="font-weight:bold;font-style:italic">map</span>[<span style="font-weight:bold">string</span>]<span style="font-weight:bold;font-style:italic">interface</span>{})
	studentInfo[<span style="color:#666;font-style:italic">&#34;name&#34;</span>] = <span style="color:#666;font-style:italic">&#34;张三&#34;</span>
	studentInfo[<span style="color:#666;font-style:italic">&#34;age&#34;</span>] = 18
	studentInfo[<span style="color:#666;font-style:italic">&#34;married&#34;</span>] = <span style="font-weight:bold">false</span>
	fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(studentInfo)
</code></pre></td></tr></table>
</div>
</div><h2 id="类型断言">类型断言</h2>
<p>空接口可以存储任意类型的值，那我们如何获取其存储的具体数据呢？</p>
<h3 id="接口值">接口值</h3>
<p>一个接口的值（简称接口值）是由<code>一个具体类型</code>和<code>具体类型的值</code>两部分组成的。这两部分分别称为接口的<code>动态类型</code>和<code>动态值</code>。</p>
<p>我们来看一个具体的例子：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">var</span> w io.Writer
w = os.Stdout
w = <span style="font-weight:bold;font-style:italic">new</span>(bytes.Buffer)
w = <span style="font-weight:bold">nil</span>
</code></pre></td></tr></table>
</div>
</div><p>请看下图分解：
        <a data-fancybox="gallery" href="https://imw7.github.io/images/Go/interface/interface.png">
            <img class="mx-auto" alt="接口值图解" src="https://imw7.github.io/images/Go/interface/interface.png" />
        </a>
    </p>
<p>想要判断空接口中的值这个时候就可以使用类型断言，其语法格式：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">x.(T)
</code></pre></td></tr></table>
</div>
</div><p>其中：</p>
<ul>
<li>x：表示类型为<code>interface{}</code>的变量</li>
<li>T：表示断言<code>x</code>可能是的类型。</li>
</ul>
<p>该语法返回两个参数，第一个参数是<code>x</code>转化为<code>T</code>类型后的变量，第二个值是一个布尔值，若为<code>true</code>则表示断言成功，为<code>false</code>则表示断言失败。</p>
<p>举个例子：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	<span style="font-weight:bold;font-style:italic">var</span> x <span style="font-weight:bold;font-style:italic">interface</span>{}
	x = <span style="color:#666;font-style:italic">&#34;Hello 世界&#34;</span>
	v, ok := x.(<span style="font-weight:bold">string</span>)
	<span style="font-weight:bold">if</span> ok {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(v)
	} <span style="font-weight:bold">else</span> {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;类型断言失败&#34;</span>)
	}
}
</code></pre></td></tr></table>
</div>
</div><p>上面的示例中如果要断言多次就需要写多个<code>if</code>判断，这个时候我们可以使用<code>switch</code>语句来实现：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">justifyType</span>(x <span style="font-weight:bold;font-style:italic">interface</span>{}) {
	<span style="font-weight:bold">switch</span> v := x.(<span style="font-weight:bold;font-style:italic">type</span>) {
	<span style="font-weight:bold">case</span> <span style="font-weight:bold">string</span>:
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;x is a string，value is %v\n&#34;</span>, v)
	<span style="font-weight:bold">case</span> <span style="font-weight:bold">int</span>:
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;x is a int is %v\n&#34;</span>, v)
	<span style="font-weight:bold">case</span> <span style="font-weight:bold">bool</span>:
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;x is a bool is %v\n&#34;</span>, v)
	<span style="font-weight:bold">default</span>:
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;unsupport type！&#34;</span>)
	}
}
</code></pre></td></tr></table>
</div>
</div><p>因为空接口可以存储任意类型值的特点，所以空接口在Go语言中的使用十分广泛。</p>
<p>关于接口需要注意的是，只有当有两个或两个以上的具体类型必须以相同的方式进行处理时才需要定义接口。不要为了接口而写接口，那样只会增加不必要的抽象，导致不必要的运行时损耗。</p>
<h1 id="练习题">练习题</h1>
<p>使用接口的方式实现一个既可以往终端写日志也可以往文件写日志的简易日志库。</p>
<p><code>mylogger</code>包下有三个Go文件：</p>
<p>1.<code>mylogger.go</code>自定义日志库</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold">package</span> mylogger

<span style="color:#888;font-style:italic">// 自定义一个日志库
</span><span style="color:#888;font-style:italic"></span>
<span style="font-weight:bold">import</span> (
	<span style="color:#666;font-style:italic">&#34;errors&#34;</span>
	<span style="color:#666;font-style:italic">&#34;fmt&#34;</span>
	<span style="color:#666;font-style:italic">&#34;path&#34;</span>
	<span style="color:#666;font-style:italic">&#34;runtime&#34;</span>
	<span style="color:#666;font-style:italic">&#34;strings&#34;</span>
)

<span style="font-weight:bold;font-style:italic">type</span> LogLevel <span style="font-weight:bold">uint16</span>

<span style="color:#888;font-style:italic">// Logger 接口
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> Logger <span style="font-weight:bold;font-style:italic">interface</span> {
	<span style="color:#666;font-weight:bold;font-style:italic">Debug</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{})
	<span style="color:#666;font-weight:bold;font-style:italic">Info</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{})
	<span style="color:#666;font-weight:bold;font-style:italic">Warning</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{})
	<span style="color:#666;font-weight:bold;font-style:italic">Error</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{})
	<span style="color:#666;font-weight:bold;font-style:italic">Fatal</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{})
}

<span style="font-weight:bold;font-style:italic">const</span> (
	UNKNOWN LogLevel = <span style="font-weight:bold">iota</span>
	DEBUG
	TRACE
	INFO
	WARNING
	ERROR
	FATAL
)

<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">parseLogLevel</span>(s <span style="font-weight:bold">string</span>) (LogLevel, <span style="font-weight:bold">error</span>) {
	s = strings.<span style="color:#666;font-weight:bold;font-style:italic">ToLower</span>(s)
	<span style="font-weight:bold">switch</span> s {
	<span style="font-weight:bold">case</span> <span style="color:#666;font-style:italic">&#34;debug&#34;</span>:
		<span style="font-weight:bold">return</span> DEBUG, <span style="font-weight:bold">nil</span>
	<span style="font-weight:bold">case</span> <span style="color:#666;font-style:italic">&#34;trace&#34;</span>:
		<span style="font-weight:bold">return</span> TRACE, <span style="font-weight:bold">nil</span>
	<span style="font-weight:bold">case</span> <span style="color:#666;font-style:italic">&#34;info&#34;</span>:
		<span style="font-weight:bold">return</span> INFO, <span style="font-weight:bold">nil</span>
	<span style="font-weight:bold">case</span> <span style="color:#666;font-style:italic">&#34;warning&#34;</span>:
		<span style="font-weight:bold">return</span> WARNING, <span style="font-weight:bold">nil</span>
	<span style="font-weight:bold">case</span> <span style="color:#666;font-style:italic">&#34;error&#34;</span>:
		<span style="font-weight:bold">return</span> ERROR, <span style="font-weight:bold">nil</span>
	<span style="font-weight:bold">case</span> <span style="color:#666;font-style:italic">&#34;fatal&#34;</span>:
		<span style="font-weight:bold">return</span> FATAL, <span style="font-weight:bold">nil</span>
	<span style="font-weight:bold">default</span>:
		err := errors.<span style="color:#666;font-weight:bold;font-style:italic">New</span>(<span style="color:#666;font-style:italic">&#34;无效的日志级别&#34;</span>)
		<span style="font-weight:bold">return</span> UNKNOWN, err
	}
}

<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">getLogString</span>(lv LogLevel) <span style="font-weight:bold">string</span> {
	<span style="font-weight:bold">switch</span> lv {
	<span style="font-weight:bold">case</span> DEBUG:
		<span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;DEBUG&#34;</span>
	<span style="font-weight:bold">case</span> TRACE:
		<span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;TRACE&#34;</span>
	<span style="font-weight:bold">case</span> INFO:
		<span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;INFO&#34;</span>
	<span style="font-weight:bold">case</span> WARNING:
		<span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;WARNING&#34;</span>
	<span style="font-weight:bold">case</span> ERROR:
		<span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;ERROR&#34;</span>
	<span style="font-weight:bold">case</span> FATAL:
		<span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;FATAL&#34;</span>
	<span style="font-weight:bold">default</span>:
		<span style="font-weight:bold">return</span> <span style="color:#666;font-style:italic">&#34;DEBUG&#34;</span>
	}
}

<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">getInfo</span>(skip <span style="font-weight:bold">int</span>) (funcName, fileName <span style="font-weight:bold">string</span>, lineNo <span style="font-weight:bold">int</span>) {
	pc, file, lineNo, ok := runtime.<span style="color:#666;font-weight:bold;font-style:italic">Caller</span>(skip)
	<span style="font-weight:bold">if</span> !ok {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;runtime.Caller() failed.\n&#34;</span>)
		<span style="font-weight:bold">return</span>
	}
	funcName = runtime.<span style="color:#666;font-weight:bold;font-style:italic">FuncForPC</span>(pc).<span style="color:#666;font-weight:bold;font-style:italic">Name</span>()
	fileName = path.<span style="color:#666;font-weight:bold;font-style:italic">Base</span>(file)
	funcName = strings.<span style="color:#666;font-weight:bold;font-style:italic">Split</span>(funcName, <span style="color:#666;font-style:italic">&#34;.&#34;</span>)[1]
	<span style="font-weight:bold">return</span>
}
</code></pre></td></tr></table>
</div>
</div><p>2.<code>console.go</code>往终端中写日志文件</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold">package</span> mylogger

<span style="font-weight:bold">import</span> (
	<span style="color:#666;font-style:italic">&#34;fmt&#34;</span>
	<span style="color:#666;font-style:italic">&#34;time&#34;</span>
)

<span style="color:#888;font-style:italic">// 往终端写日志相关内容
</span><span style="color:#888;font-style:italic"></span>
<span style="color:#888;font-style:italic">// ConsoleLogger 日志结构体
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> ConsoleLogger <span style="font-weight:bold;font-style:italic">struct</span> {
	Level LogLevel
}

<span style="color:#888;font-style:italic">// NewLog 构造函数
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">NewConsoleLog</span>(levelStr <span style="font-weight:bold">string</span>) ConsoleLogger {
	level, err := <span style="color:#666;font-weight:bold;font-style:italic">parseLogLevel</span>(levelStr)
	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		<span style="font-weight:bold;font-style:italic">panic</span>(err)
	}
	<span style="font-weight:bold">return</span> ConsoleLogger{
		Level: level,
	}
}

<span style="font-weight:bold;font-style:italic">func</span> (c ConsoleLogger) <span style="color:#666;font-weight:bold;font-style:italic">enable</span>(logLevel LogLevel) <span style="font-weight:bold">bool</span> {
	<span style="font-weight:bold">return</span> c.Level &lt;= logLevel
}

<span style="font-weight:bold;font-style:italic">func</span> (c ConsoleLogger) <span style="color:#666;font-weight:bold;font-style:italic">log</span>(lv LogLevel, format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	<span style="font-weight:bold">if</span> c.<span style="color:#666;font-weight:bold;font-style:italic">enable</span>(DEBUG) {
		msg := fmt.<span style="color:#666;font-weight:bold;font-style:italic">Sprintf</span>(format, a...)
		now := time.<span style="color:#666;font-weight:bold;font-style:italic">Now</span>()
		funcName, fileName, lineNo := <span style="color:#666;font-weight:bold;font-style:italic">getInfo</span>(3)
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Printf</span>(<span style="color:#666;font-style:italic">&#34;[%s] [%s] [%s:%s:%d] %s\n&#34;</span>,
			now.<span style="color:#666;font-weight:bold;font-style:italic">Format</span>(<span style="color:#666;font-style:italic">&#34;2006-01-02 15:04:05&#34;</span>),
			<span style="color:#666;font-weight:bold;font-style:italic">getLogString</span>(lv), fileName, funcName, lineNo, msg)
	}
}

<span style="font-weight:bold;font-style:italic">func</span> (c ConsoleLogger) <span style="color:#666;font-weight:bold;font-style:italic">Debug</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	c.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(DEBUG, format, a...)
}

<span style="font-weight:bold;font-style:italic">func</span> (c ConsoleLogger) <span style="color:#666;font-weight:bold;font-style:italic">Info</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	c.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(DEBUG, format, a...)
}

<span style="font-weight:bold;font-style:italic">func</span> (c ConsoleLogger) <span style="color:#666;font-weight:bold;font-style:italic">Warning</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	c.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(DEBUG, format, a...)
}

<span style="font-weight:bold;font-style:italic">func</span> (c ConsoleLogger) <span style="color:#666;font-weight:bold;font-style:italic">Error</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	c.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(DEBUG, format, a...)
}

<span style="font-weight:bold;font-style:italic">func</span> (c ConsoleLogger) <span style="color:#666;font-weight:bold;font-style:italic">Fatal</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	c.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(DEBUG, format, a...)
}
</code></pre></td></tr></table>
</div>
</div><p>3.<code>file.go</code>往文件里写日志文件</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">  9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 97
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 98
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 99
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">100
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">101
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">102
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">103
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">104
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">105
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">106
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">107
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">108
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">109
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">110
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">111
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">112
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">113
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">114
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">115
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">116
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">117
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">118
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">119
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">120
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">121
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">122
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">123
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">124
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">125
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">126
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">127
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">128
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">129
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">130
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">131
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">132
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">133
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">134
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">135
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">136
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">137
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">138
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">139
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">140
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">141
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">142
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">143
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">144
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">145
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">146
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">147
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">148
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">149
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">150
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">151
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">152
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">153
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">154
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">155
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">156
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">157
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">158
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">159
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">160
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">161
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">162
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold">package</span> mylogger

<span style="font-weight:bold">import</span> (
	<span style="color:#666;font-style:italic">&#34;fmt&#34;</span>
	<span style="color:#666;font-style:italic">&#34;os&#34;</span>
	<span style="color:#666;font-style:italic">&#34;path&#34;</span>
	<span style="color:#666;font-style:italic">&#34;time&#34;</span>
)

<span style="color:#888;font-style:italic">// 往文件里面写日志相关代码
</span><span style="color:#888;font-style:italic"></span>
<span style="color:#888;font-style:italic">// FileLogger 文件日志结构体
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">type</span> FileLogger <span style="font-weight:bold;font-style:italic">struct</span> {
	Level       LogLevel
	filePath    <span style="font-weight:bold">string</span> <span style="color:#888;font-style:italic">// 日志文件保存的路径
</span><span style="color:#888;font-style:italic"></span>	fileName    <span style="font-weight:bold">string</span> <span style="color:#888;font-style:italic">// 日志文件保存的文件名
</span><span style="color:#888;font-style:italic"></span>	fileObj     *os.File
	errFileObj  *os.File
	maxFileSize <span style="font-weight:bold">int64</span>
}

<span style="color:#888;font-style:italic">// NewFileLogger 构造函数
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">NewFileLogger</span>(levelStr, fp, fn <span style="font-weight:bold">string</span>, maxSize <span style="font-weight:bold">int64</span>) *FileLogger {
	logLevel, err := <span style="color:#666;font-weight:bold;font-style:italic">parseLogLevel</span>(levelStr)
	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		<span style="font-weight:bold;font-style:italic">panic</span>(err)
	}
	fl := &amp;FileLogger{
		Level:       logLevel,
		filePath:    fp,
		fileName:    fn,
		maxFileSize: maxSize,
	}
	err = fl.<span style="color:#666;font-weight:bold;font-style:italic">initFile</span>() <span style="color:#888;font-style:italic">// 按照文件路径和文件名将文件打开
</span><span style="color:#888;font-style:italic"></span>	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		<span style="font-weight:bold;font-style:italic">panic</span>(err)
	}
	<span style="font-weight:bold">return</span> fl
}

<span style="color:#888;font-style:italic">// 根据指定的日志文件路径和文件名打开日志文件
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">initFile</span>() <span style="font-weight:bold">error</span> {
	fullFileName := path.<span style="color:#666;font-weight:bold;font-style:italic">Join</span>(f.filePath, f.fileName)
	fileObj, err := os.<span style="color:#666;font-weight:bold;font-style:italic">OpenFile</span>(fullFileName, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0644)
	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;Open log file failed, err:&#34;</span>, err)
		<span style="font-weight:bold">return</span> err
	}
	errFileObj, err := os.<span style="color:#666;font-weight:bold;font-style:italic">OpenFile</span>(fullFileName+<span style="color:#666;font-style:italic">&#34;.err&#34;</span>, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0644)
	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;Open err log file failed, err:&#34;</span>, err)
		<span style="font-weight:bold">return</span> err
	}
	<span style="color:#888;font-style:italic">// 日志文件都已经打开了
</span><span style="color:#888;font-style:italic"></span>	f.fileObj = fileObj
	f.errFileObj = errFileObj
	<span style="font-weight:bold">return</span> <span style="font-weight:bold">nil</span>
}

<span style="color:#888;font-style:italic">// 判断是否需要记录日志
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">enable</span>(logLevel LogLevel) <span style="font-weight:bold">bool</span> {
	<span style="font-weight:bold">return</span> f.Level &lt;= logLevel
}

<span style="color:#888;font-style:italic">// 判断文件是否需要切割
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">checkSize</span>(file *os.File) <span style="font-weight:bold">bool</span> {
	fileInfo, err := file.<span style="color:#666;font-weight:bold;font-style:italic">Stat</span>()
	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Print</span>(<span style="color:#666;font-style:italic">&#34;Open file failed, err:&#34;</span>, err)
		<span style="font-weight:bold">return</span> <span style="font-weight:bold">false</span>
	}
	<span style="color:#888;font-style:italic">// 如果当前文件大小 &gt;= 日志文件的最大值，就应该返回true
</span><span style="color:#888;font-style:italic"></span>	<span style="font-weight:bold">return</span> fileInfo.<span style="color:#666;font-weight:bold;font-style:italic">Size</span>() &gt;= f.maxFileSize
}

<span style="color:#888;font-style:italic">// 切割文件
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">splitFile</span>(file *os.File) (*os.File, <span style="font-weight:bold">error</span>) {
	<span style="color:#888;font-style:italic">// 需要切割日志文件
</span><span style="color:#888;font-style:italic"></span>	nowStr := time.<span style="color:#666;font-weight:bold;font-style:italic">Now</span>().<span style="color:#666;font-weight:bold;font-style:italic">Format</span>(<span style="color:#666;font-style:italic">&#34;20060102150405000&#34;</span>)
	fileInfo, err := file.<span style="color:#666;font-weight:bold;font-style:italic">Stat</span>()
	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;Get file information failed, err:&#34;</span>, err)
		<span style="font-weight:bold">return</span> <span style="font-weight:bold">nil</span>, err
	}
	logName := path.<span style="color:#666;font-weight:bold;font-style:italic">Join</span>(f.filePath, fileInfo.<span style="color:#666;font-weight:bold;font-style:italic">Name</span>())      <span style="color:#888;font-style:italic">// 拿到当前的日志文件完整路径
</span><span style="color:#888;font-style:italic"></span>	newLogName := fmt.<span style="color:#666;font-weight:bold;font-style:italic">Sprintf</span>(<span style="color:#666;font-style:italic">&#34;%s.bak%s&#34;</span>, logName, nowStr) <span style="color:#888;font-style:italic">// 拼接一个日志文件备份的名字
</span><span style="color:#888;font-style:italic"></span>	<span style="color:#888;font-style:italic">// 1. 关闭当前的日志文件
</span><span style="color:#888;font-style:italic"></span>	_ = file.<span style="color:#666;font-weight:bold;font-style:italic">Close</span>()
	<span style="color:#888;font-style:italic">// 2. 备份一下 rename  xx.log -&gt; xx.log.bak202006072123
</span><span style="color:#888;font-style:italic"></span>	_ = os.<span style="color:#666;font-weight:bold;font-style:italic">Rename</span>(logName, newLogName)
	<span style="color:#888;font-style:italic">// 3. 打开一个新的日志文件
</span><span style="color:#888;font-style:italic"></span>	fileObj, err := os.<span style="color:#666;font-weight:bold;font-style:italic">OpenFile</span>(logName, os.O_CREATE|os.O_APPEND|os.O_WRONLY, 0644)
	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;Open new log file failed, err:&#34;</span>, err)
		<span style="font-weight:bold">return</span> <span style="font-weight:bold">nil</span>, err
	}
	<span style="color:#888;font-style:italic">// 4. 将打开的新日志文件对象赋值给 f.fileObj
</span><span style="color:#888;font-style:italic"></span>	<span style="font-weight:bold">return</span> fileObj, <span style="font-weight:bold">nil</span>
}

<span style="color:#888;font-style:italic">// 记录日志的方法
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">log</span>(lv LogLevel, format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	<span style="font-weight:bold">if</span> f.<span style="color:#666;font-weight:bold;font-style:italic">enable</span>(lv) {
		msg := fmt.<span style="color:#666;font-weight:bold;font-style:italic">Sprintf</span>(format, a...)
		now := time.<span style="color:#666;font-weight:bold;font-style:italic">Now</span>()
		funcName, fileName, lineNo := <span style="color:#666;font-weight:bold;font-style:italic">getInfo</span>(3)
		<span style="font-weight:bold">if</span> f.<span style="color:#666;font-weight:bold;font-style:italic">checkSize</span>(f.fileObj) {
			newFile, err := f.<span style="color:#666;font-weight:bold;font-style:italic">splitFile</span>(f.fileObj) <span style="color:#888;font-style:italic">// 日志文件
</span><span style="color:#888;font-style:italic"></span>			<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
				<span style="font-weight:bold">return</span>
			}
			f.fileObj = newFile
		}
		_, _ = fmt.<span style="color:#666;font-weight:bold;font-style:italic">Fprintf</span>(f.fileObj, <span style="color:#666;font-style:italic">&#34;[%s] [%s] [%s:%s:%d] %s\n&#34;</span>,
			now.<span style="color:#666;font-weight:bold;font-style:italic">Format</span>(<span style="color:#666;font-style:italic">&#34;2006-01-02 15:04:05&#34;</span>),
			<span style="color:#666;font-weight:bold;font-style:italic">getLogString</span>(lv), fileName, funcName, lineNo, msg)
		<span style="font-weight:bold">if</span> lv &gt;= ERROR {
			<span style="font-weight:bold">if</span> f.<span style="color:#666;font-weight:bold;font-style:italic">checkSize</span>(f.errFileObj) {
				newFile, err := f.<span style="color:#666;font-weight:bold;font-style:italic">splitFile</span>(f.errFileObj) <span style="color:#888;font-style:italic">// 日志文件
</span><span style="color:#888;font-style:italic"></span>				<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
					<span style="font-weight:bold">return</span>
				}
				f.errFileObj = newFile
			}
			<span style="color:#888;font-style:italic">// 如果要记录的日志大于ERROR级别，还要在 err 日志文件中再记录一次
</span><span style="color:#888;font-style:italic"></span>			_, _ = fmt.<span style="color:#666;font-weight:bold;font-style:italic">Fprintf</span>(f.errFileObj, <span style="color:#666;font-style:italic">&#34;[%s] [%s] [%s:%s:%d] %s\n&#34;</span>,
				now.<span style="color:#666;font-weight:bold;font-style:italic">Format</span>(<span style="color:#666;font-style:italic">&#34;2006-01-02 15:04:05&#34;</span>),
				<span style="color:#666;font-weight:bold;font-style:italic">getLogString</span>(lv), fileName, funcName, lineNo, msg)
		}
	}
}

<span style="color:#888;font-style:italic">// Debug ...
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">Debug</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	f.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(DEBUG, format, a...)
}

<span style="color:#888;font-style:italic">// Info ...
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">Info</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	f.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(INFO, format, a...)
}

<span style="color:#888;font-style:italic">// Warning ...
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">Warning</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	f.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(WARNING, format, a...)
}

<span style="color:#888;font-style:italic">// Error ...
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">Error</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	f.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(ERROR, format, a...)
}

<span style="color:#888;font-style:italic">// Fatal ...
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">Fatal</span>(format <span style="font-weight:bold">string</span>, a ...<span style="font-weight:bold;font-style:italic">interface</span>{}) {
	f.<span style="color:#666;font-weight:bold;font-style:italic">log</span>(FATAL, format, a...)
}

<span style="color:#888;font-style:italic">// 关闭文件
</span><span style="color:#888;font-style:italic"></span><span style="font-weight:bold;font-style:italic">func</span> (f *FileLogger) <span style="color:#666;font-weight:bold;font-style:italic">Close</span>() {
	_ = f.fileObj.<span style="color:#666;font-weight:bold;font-style:italic">Close</span>()
	_ = f.errFileObj.<span style="color:#666;font-weight:bold;font-style:italic">Close</span>()
}
</code></pre></td></tr></table>
</div>
</div><p><code>log_demo</code>包下的<code>main.go</code>主程序，测试日志库是否正常工作</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="font-weight:bold">package</span> main

<span style="font-weight:bold">import</span> (
	<span style="color:#666;font-style:italic">&#34;fmt&#34;</span>
	<span style="color:#666;font-style:italic">&#34;log&#34;</span>
	<span style="color:#666;font-style:italic">&#34;os&#34;</span>
	<span style="color:#666;font-style:italic">&#34;time&#34;</span>
)

<span style="color:#888;font-style:italic">// log demo
</span><span style="color:#888;font-style:italic"></span>
<span style="font-weight:bold;font-style:italic">func</span> <span style="color:#666;font-weight:bold;font-style:italic">main</span>() {
	fileObj, err := os.<span style="color:#666;font-weight:bold;font-style:italic">OpenFile</span>(<span style="color:#666;font-style:italic">&#34;./xx.log&#34;</span>, os.O_APPEND|os.O_CREATE|os.O_WRONLY, 0644)
	<span style="font-weight:bold">if</span> err != <span style="font-weight:bold">nil</span> {
		fmt.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;Open file failed, err:&#34;</span>, err)
		<span style="font-weight:bold">return</span>
	}
	log.<span style="color:#666;font-weight:bold;font-style:italic">SetOutput</span>(fileObj)
	<span style="font-weight:bold">for</span> {
		log.<span style="color:#666;font-weight:bold;font-style:italic">Println</span>(<span style="color:#666;font-style:italic">&#34;这是一条测试的日志&#34;</span>)
		time.<span style="color:#666;font-weight:bold;font-style:italic">Sleep</span>(time.Second * 3)
	}
}
</code></pre></td></tr></table>
</div>
</div>
        </div>

        


        

<div class="post-archive">
    <h2>请参阅</h2>
    <ul class="listing">
        
        <li><a href="/post/Go/13_reflect/">Go语言基础之反射</a></li>
        
        <li><a href="/post/Go/11_package/">Go语言基础之包</a></li>
        
        <li><a href="/post/Go/10_struct/">Go语言基础之结构体</a></li>
        
        <li><a href="/post/Go/09_function/">Go语言基础之函数</a></li>
        
        <li><a href="/post/Go/08_map/">Go语言基础之map</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/interface'>interface</a></li>
                
                <li><a href='/tags/%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80'>类型断言</a></li>
                
                <li><a href='/tags/%E5%9F%BA%E7%A1%80'>基础</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                    <footer id="footer">
    <div>
        &copy; 2022 <a href="https://blog.imw7.com/">魏奇的博客 By 魏奇</a>
        
        | <a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/">蜀ICP备2022000811号-1</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script><script src="https://cdn.bootcdn.net/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js"></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




    <script src='/js/douban.js'></script>


                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://blog.imw7.com/search/' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://blog.imw7.com/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://blog.imw7.com/post/mysql/" title="在CentOS7.x上安装MySQL8.0">在CentOS7.x上安装MySQL8.0</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/redis_on_centos/" title="CentOS与Redis">CentOS与Redis</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/ssh_upload_download/" title="ssh使用scp或rsync上传和下载文件">ssh使用scp或rsync上传和下载文件</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/http/" title="HTTP协议">HTTP协议</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/Go/project_struct/" title="一般项目的结构">一般项目的结构</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/Go/bcrypt/" title="密码加密">密码加密</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/Go/makefile/" title="为Go项目编写Makefile">为Go项目编写Makefile</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/Go/go_micro/" title="go-micro">go-micro</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/Go/grpc/" title="gRPC">gRPC</a>
    </li>
    
    <li>
        <a href="https://blog.imw7.com/post/ubuntu_firefox_blibili/" title="Ubuntu下Firefox使用HTML5播放器看B站">Ubuntu下Firefox使用HTML5播放器看B站</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://blog.imw7.com/categories/Docker/">Docker (1)</a></li>
    
    <li><a href="https://blog.imw7.com/categories/Go/">Go (52)</a></li>
    
    <li><a href="https://blog.imw7.com/categories/Hexo/">Hexo (1)</a></li>
    
    <li><a href="https://blog.imw7.com/categories/git/">git (1)</a></li>
    
    <li><a href="https://blog.imw7.com/categories/%E5%85%B6%E4%BB%96/">其他 (1)</a></li>
    
    <li><a href="https://blog.imw7.com/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器 (3)</a></li>
    
    <li><a href="https://blog.imw7.com/categories/%E7%AE%97%E6%B3%95/">算法 (1)</a></li>
    
    <li><a href="https://blog.imw7.com/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/">计算机网络 (1)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
    
    <a href="https://blog.imw7.com/tags/Bcrypt/">Bcrypt</a>
    
    <a href="https://blog.imw7.com/tags/Cookie/">Cookie</a>
    
    <a href="https://blog.imw7.com/tags/Docker/">Docker</a>
    
    <a href="https://blog.imw7.com/tags/ES/">ES</a>
    
    <a href="https://blog.imw7.com/tags/GMP/">GMP</a>
    
    <a href="https://blog.imw7.com/tags/Hexo/">Hexo</a>
    
    <a href="https://blog.imw7.com/tags/Kafka/">Kafka</a>
    
    <a href="https://blog.imw7.com/tags/Kibana/">Kibana</a>
    
    <a href="https://blog.imw7.com/tags/MongoDB/">MongoDB</a>
    
    <a href="https://blog.imw7.com/tags/MySQL/">MySQL</a>
    
    <a href="https://blog.imw7.com/tags/NSQ/">NSQ</a>
    
    <a href="https://blog.imw7.com/tags/Redis/">Redis</a>
    
    <a href="https://blog.imw7.com/tags/Session/">Session</a>
    
    <a href="https://blog.imw7.com/tags/VS-Code/">VS Code</a>
    
    <a href="https://blog.imw7.com/tags/Web%E5%BC%80%E5%8F%91/">Web开发</a>
    
    <a href="https://blog.imw7.com/tags/centos/">centos</a>
    
    <a href="https://blog.imw7.com/tags/channel/">channel</a>
    
    <a href="https://blog.imw7.com/tags/context/">context</a>
    
    <a href="https://blog.imw7.com/tags/etcd/">etcd</a>
    
    <a href="https://blog.imw7.com/tags/flag/">flag</a>
    
    <a href="https://blog.imw7.com/tags/fmt/">fmt</a>
    
    <a href="https://blog.imw7.com/tags/gin/">gin</a>
    
    <a href="https://blog.imw7.com/tags/git/">git</a>
    
    <a href="https://blog.imw7.com/tags/go-micro/">go-micro</a>
    
    <a href="https://blog.imw7.com/tags/go-module/">go module</a>
    
    <a href="https://blog.imw7.com/tags/goroutine/">goroutine</a>
    
    <a href="https://blog.imw7.com/tags/grpc/">grpc</a>
    
    <a href="https://blog.imw7.com/tags/http/">http</a>
    
    <a href="https://blog.imw7.com/tags/interface/">interface</a>
    
    <a href="https://blog.imw7.com/tags/iota/">iota</a>
    
    <a href="https://blog.imw7.com/tags/jwt/">jwt</a>
    
    <a href="https://blog.imw7.com/tags/log/">log</a>
    
    <a href="https://blog.imw7.com/tags/logrus/">logrus</a>
    
    <a href="https://blog.imw7.com/tags/makefile/">makefile</a>
    
    <a href="https://blog.imw7.com/tags/map/">map</a>
    
    <a href="https://blog.imw7.com/tags/MySQL/">MySQL</a>
    
    <a href="https://blog.imw7.com/tags/net/http/">net/http</a>
    
    <a href="https://blog.imw7.com/tags/os.Args/">os.Args</a>
    
    <a href="https://blog.imw7.com/tags/package/">package</a>
    
    <a href="https://blog.imw7.com/tags/pprof/">pprof</a>
    
    <a href="https://blog.imw7.com/tags/protobuf/">protobuf</a>
    
    <a href="https://blog.imw7.com/tags/sarama/">sarama</a>
    
    <a href="https://blog.imw7.com/tags/sqlx/">sqlx</a>
    
    <a href="https://blog.imw7.com/tags/ssh/">ssh</a>
    
    <a href="https://blog.imw7.com/tags/strconv/">strconv</a>
    
    <a href="https://blog.imw7.com/tags/tailf/">tailf</a>
    
    <a href="https://blog.imw7.com/tags/template/">template</a>
    
    <a href="https://blog.imw7.com/tags/time/">time</a>
    
    <a href="https://blog.imw7.com/tags/viper/">viper</a>
    
    <a href="https://blog.imw7.com/tags/yilia/">yilia</a>
    
    <a href="https://blog.imw7.com/tags/%E4%B8%8A%E4%BC%A0%E6%96%87%E4%BB%B6/">上传文件</a>
    
    <a href="https://blog.imw7.com/tags/%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86/">依赖管理</a>
    
    <a href="https://blog.imw7.com/tags/%E5%87%BD%E6%95%B0/">函数</a>
    
    <a href="https://blog.imw7.com/tags/%E5%88%87%E7%89%87/">切片</a>
    
    <a href="https://blog.imw7.com/tags/%E5%8F%8D%E5%B0%84/">反射</a>
    
    <a href="https://blog.imw7.com/tags/%E5%8F%98%E9%87%8F%E5%92%8C%E5%B8%B8%E9%87%8F/">变量和常量</a>
    
    <a href="https://blog.imw7.com/tags/%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">基本数据类型</a>
    
    <a href="https://blog.imw7.com/tags/%E5%9F%BA%E7%A1%80/">基础</a>
    
    <a href="https://blog.imw7.com/tags/%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86/">密码加密</a>
    
    <a href="https://blog.imw7.com/tags/%E5%AF%BC%E5%85%A5%E6%9C%AC%E5%9C%B0%E5%8C%85/">导入本地包</a>
    
    <a href="https://blog.imw7.com/tags/%E5%B8%B8%E7%94%A8%E6%A1%86%E6%9E%B6%E5%92%8C%E7%BB%84%E4%BB%B6/">常用框架和组件</a>
    
    <a href="https://blog.imw7.com/tags/%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6%E4%B8%8E%E6%8A%80%E5%B7%A7/">常用组件与技巧</a>
    
    <a href="https://blog.imw7.com/tags/%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6%E5%92%8C%E6%8A%80%E5%B7%A7/">常用组件和技巧</a>
    
    <a href="https://blog.imw7.com/tags/%E5%B9%B6%E5%8F%91/">并发</a>
    
    <a href="https://blog.imw7.com/tags/%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87/">开发环境准备</a>
    
    <a href="https://blog.imw7.com/tags/%E5%BC%82%E6%88%96/">异或</a>
    
    <a href="https://blog.imw7.com/tags/%E6%8C%87%E9%92%88/">指针</a>
    
    <a href="https://blog.imw7.com/tags/%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/">排序算法</a>
    
    <a href="https://blog.imw7.com/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a>
    
    <a href="https://blog.imw7.com/tags/%E6%95%B0%E7%BB%84/">数组</a>
    
    <a href="https://blog.imw7.com/tags/%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C/">文件操作</a>
    
    <a href="https://blog.imw7.com/tags/%E6%A0%87%E5%87%86%E5%BA%93/">标准库</a>
    
    <a href="https://blog.imw7.com/tags/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/">流程控制</a>
    
    <a href="https://blog.imw7.com/tags/%E6%B5%8B%E8%AF%95/">测试</a>
    
    <a href="https://blog.imw7.com/tags/%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80/">类型断言</a>
    
    <a href="https://blog.imw7.com/tags/%E7%BB%93%E6%9E%84%E4%BD%93/">结构体</a>
    
    <a href="https://blog.imw7.com/tags/%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/">网络编程</a>
    
    <a href="https://blog.imw7.com/tags/%E8%B7%A8%E5%B9%B3%E5%8F%B0%E7%BC%96%E8%AF%91/">跨平台编译</a>
    
    <a href="https://blog.imw7.com/tags/%E8%BF%90%E7%AE%97%E7%AC%A6/">运算符</a>
    
    <a href="https://blog.imw7.com/tags/%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84/">项目结构</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://www.imw7.com/" title="魏奇的博客">魏奇的博客</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://blog.imw7.com/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>